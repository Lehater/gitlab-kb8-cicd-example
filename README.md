# Описание задания

В этом задании вы создадите полноценный CI/CD конвейер с использованием **GitLab** и **Kubernetes**. Вы настроите
автоматическое развертывание приложения на кластер Kubernetes при каждом коммите в репозиторий GitLab. Это задание
поможет вам понять, как интегрировать системы управления версиями с оркестрацией контейнеров для автоматизации процесса
разработки и развертывания.

---

## Шаги выполнения

### 1. Подготовка окружения

- Настройте **Kubernetes** кластер (например, Minikube для локальной разработки).
- Установите и настройте **kubectl** для управления кластером Kubernetes.
- Выберите проект, который будете билдить и деплоить в кластер Kubernetes при помощи **GitLab**.

### 2. Установка GitLab Kubernetes Agent

- Установите **GitLab Kubernetes Agent** в ваш Kubernetes кластер. Это позволит GitLab взаимодействовать с вашим
  кластером напрямую.

### 3. Создание проекта и добавление приложения

- Создайте новый проект в **GitLab** и добавьте код вашего приложения.
- В корне репозитория создайте файл `Dockerfile` для сборки Docker образа вашего приложения.

### 4. Создание Kubernetes манифестов

- В репозитории создайте директорию `k8s` и добавьте туда манифесты для **Deployment** и **Service**.
- Создайте отдельные манифесты для различных окружений (**staging** и **production**).

### 5. Настройка CI/CD конвейера в GitLab

- В корне репозитория создайте файл `.gitlab-ci.yml`.
- Определите пайплайн с несколькими стадиями:
    - `build`
    - `test`
    - `deploy_staging`
    - `deploy_production`
- Настройте использование **GitLab Kubernetes Agent** для деплоя в Kubernetes.

### 6. Сборка Docker-образа

- Настройте стадию `build`, чтобы собирать Docker образ вашего приложения и загружать его в **Docker Registry**.
- Тегируйте образы в зависимости от ветки:
    - `latest` для ветки `master`.
    - Специфические теги для других веток.

### 7. Настройка окружений в GitLab

- Создайте два окружения в **GitLab**: **staging** и **production**.
- Настройте условия для стадий `deploy_staging` и `deploy_production`, чтобы развертывание происходило в соответствующие
  окружения в зависимости от ветки:
    - Развертывание в **staging** при коммите в ветку `develop`.
    - Развертывание в **production** при мерже в ветку `master`.

### 8. Развертывание в Kubernetes с использованием GitLab Kubernetes Agent

- Настройте стадии `deploy_staging` и `deploy_production` для применения Kubernetes манифестов на соответствующие
  окружения с использованием **GitLab Kubernetes Agent**.

---

## Ожидаемый результат

- Настроенный и успешно протестированный pipeline на **GitLab** с интеграцией Kubernetes.

---

## Отчет

Отчет о выполненном задании сдайте в формате **.pdf**. Загрузите файл в форму ниже.

### Отчет должен содержать:

1. Какой проект был выбран.
2. Отражение успешного выполнения каждого из шагов и непосредственно самого pipeline GitLab (скриншоты, отражающие
   успешное выполнение шагов).
3. Код файла `ci-cd.yml`.
4. Код манифестов Kubernetes.